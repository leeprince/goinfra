# 串口数据传输
---

# 子母线

## 协议兼容

在原http协议的基础上包装一层通用协议用于子母线数据传输的协议



## 协议

### 报文结构

消息头+消息体



#### 消息头

消息头：4个字节，代表消息体的长度，大端序



#### 消息体

消息体是数据部分。json字节序：包含：命令字,请求ID,请求内容

```
{
	"cmd":"命令字-A1",
	"request_id":"请求ID||log_id",
	"body":"http请求部分转json字节序-[]byte"
}
```



## 命令字映射

### 售票服务

| 对应接口       | 命令字 | 说明                   |
| -------------- | ------ | ---------------------- |
| 处理订单任务   | A1     | 售票服务接受新订单     |
| 设置自动化模式 | A2     | 售票服务设置自动化模式 |



### 平台

| 对应接口                 | 命令字 | 说明                                            |
| ------------------------ | ------ | ----------------------------------------------- |
| 回调订单处理结果         | B1     | 平台服务处理回调订单处理结果                    |
| 售票服务上报自动化模式   | B2     | 售票服务上报自动化模式                          |
| 校验售票服务是否允许运行 | B3     | 校验售票服务是否允许运行-接受售票服务的请求     |
| 校验售票服务是否允许运行 | B31    | 校验售票服务是否允许运行-平台校验结果给售票服务 |



